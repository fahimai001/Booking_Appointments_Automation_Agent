<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <title>üìÖ AI Appointment Booking</title>
</head>
<body>
  <div class="container">
    <h1>üìÖ AI Appointment Booking Assistant</h1>

    {% if not action %}
      <p class="greeting">How can I help you today?</p>
      <div class="options">
        <a class="btn" href="/?action=book">Book an Appointment</a>
        <a class="btn" href="/?action=check">Check Existing Appointment</a>
      </div>
    {% endif %}

    {% if action == 'book' %}
      <h2>Book a New Appointment</h2>

      {% if error %}
        <div class="alert error">‚ùå {{ error }}</div>
      {% endif %}
      {% if missing %}
        <div class="alert warning">‚ö†Ô∏è Missing fields: {{ missing | join(', ') }}</div>
      {% endif %}
      {% if invalid %}
        <div class="alert warning">‚ö†Ô∏è Invalid entries: {{ invalid | join(', ') }}</div>
      {% endif %}
      {% if confirmation %}
        <div class="alert success">
          ‚úÖ Appointment confirmed for <strong>{{ confirmation.name }}</strong> on <strong>{{ confirmation.date }}</strong> at <strong>{{ confirmation.time }}</strong>.<br />
          Purpose: <em>{{ confirmation.purpose }}</em>
        </div>
      {% endif %}

      <form action="/book" method="POST" novalidate>
        <input type="text" name="name" placeholder="Name" value="{{ booking_info.name if booking_info }}" required autocomplete="name" />
        <input type="email" name="email" placeholder="Email" value="{{ booking_info.email if booking_info }}" required autocomplete="email" />
        <input type="date" name="date" value="{{ booking_info.date if booking_info }}" required />
        <input type="time" name="time" value="{{ booking_info.time if booking_info }}" required />
        <input type="text" name="purpose" placeholder="Purpose" value="{{ booking_info.purpose if booking_info }}" required autocomplete="off" />
        <button type="submit">Submit Booking</button>
        <a class="link" href="/">‚Üê Back</a>
      </form>
    {% endif %}

    {% if action == 'check' %}
      <h2>Check Your Appointments</h2>

      <form action="/check" method="POST" novalidate>
        <input type="email" name="check_email" placeholder="Enter your email" value="{{ check_email if check_email }}" required autocomplete="email" />
        <button type="submit">Find Appointments</button>
        <a class="link" href="/">‚Üê Back</a>
      </form>

      {% if appointments is defined %}
        {% if not_found %}
          <div class="alert warning">‚ö†Ô∏è No appointments found for <strong>{{ check_email }}</strong>.</div>
        {% else %}
          <div class="appointments-list">
            <h3>Appointments for <span class="highlight-email">{{ check_email }}</span>:</h3>
            <table class="appointments-table" aria-label="Appointments list">
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">Time</th>
                  <th scope="col">Purpose</th>
                </tr>
              </thead>
              <tbody>
                {% for app in appointments %}
                  <tr>
                    <td>{{ app.date }}</td>
                    <td>{{ app.time }}</td>
                    <td>{{ app.purpose }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% endif %}
      {% endif %}
    {% endif %}

  </div>
</body>
</html>
